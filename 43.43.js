webpackJsonp([43],{24:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(152);t["default"]=r.Col,e.exports=t["default"]},25:88,255:function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function a(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t.uploadImageAct=t.update=t.remove=t.create=t.query=t.createGg=t.queryPay=t.updatePayImg=t.findPay=t.find=void 0;var u=n(150),s=a(u),o=n(36),i=a(o),c=n(153),l=a(c),d=(t.find=function(){var e=(0,l["default"])(i["default"].mark(function t(e){return i["default"].wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",p.read_Token(p.APIHost+"/crops/"+e,p.getAuth("/crops/"+e)).then(function(e){return e.json()}).then(function(e){return e}));case 1:case"end":return t.stop()}},t,this)}));return function(t){return e.apply(this,arguments)}}(),t.findPay=function(){var e=(0,l["default"])(i["default"].mark(function t(e){return i["default"].wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",p.read_Token(p.APIHost+"/payImg/"+e,p.getAuth("/payImg/"+e)).then(function(e){return e.json()}).then(function(e){return e}));case 1:case"end":return t.stop()}},t,this)}));return function(t){return e.apply(this,arguments)}}(),t.updatePayImg=function(){var e=(0,l["default"])(i["default"].mark(function t(e){return i["default"].wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",p.update_Token(p.APIHost+"/payImg/"+e.id,p.getAuth("/payImg/"+e.id),(0,s["default"])(e.data)).then(function(e){return e.json()}).then(function(e){return e}));case 1:case"end":return t.stop()}},t,this)}));return function(t){return e.apply(this,arguments)}}(),t.queryPay=function(){var e=(0,l["default"])(i["default"].mark(function t(e){var n;return i["default"].wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.page||(e.page=1),e.pageSize||(e.pageSize=10),!e.field){t.next=6;break}return n={},n[e.field]=e.keyword,t.abrupt("return",p.create(p.APIHost+"/crops/search/"+e.page+"/"+e.pageSize,(0,s["default"])(n)).then(function(e){return e.json()}).then(function(e){return e}));case 6:return t.abrupt("return",p.read_Token(p.APIHost+"/payImg/list",p.getAuth("/payImg/list")).then(function(e){return e.json()}).then(function(e){return e}));case 7:case"end":return t.stop()}},t,this)}));return function(t){return e.apply(this,arguments)}}(),t.createGg=function(){var e=(0,l["default"])(i["default"].mark(function t(e){return i["default"].wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",p.creat_Token(p.APIHost+"/crops/addGg",p.getAuth("/crops/addGg"),(0,s["default"])(e)).then(function(e){return e.json()}).then(function(e){return e}));case 1:case"end":return t.stop()}},t,this)}));return function(t){return e.apply(this,arguments)}}(),t.query=function(){var e=(0,l["default"])(i["default"].mark(function t(e){var n;return i["default"].wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.page||(e.page=1),e.pageSize||(e.pageSize=10),!e.field){t.next=6;break}return n={},n[e.field]=e.keyword,t.abrupt("return",p.create(p.APIHost+"/crops/search/"+e.page+"/"+e.pageSize,(0,s["default"])(n)).then(function(e){return e.json()}).then(function(e){return e}));case 6:return t.abrupt("return",p.read_Token(p.APIHost+"/crops/list",p.getAuth("/crops/list")).then(function(e){return e.json()}).then(function(e){return e}));case 7:case"end":return t.stop()}},t,this)}));return function(t){return e.apply(this,arguments)}}(),t.create=function(){var e=(0,l["default"])(i["default"].mark(function t(e){return i["default"].wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",p.creat_Token(p.APIHost+"/crops",p.getAuth("/crops"),(0,s["default"])(e)).then(function(e){return e.json()}).then(function(e){return e}));case 1:case"end":return t.stop()}},t,this)}));return function(t){return e.apply(this,arguments)}}(),t.remove=function(){var e=(0,l["default"])(i["default"].mark(function t(e){return i["default"].wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",p.delete_Token(p.APIHost+"/crops/"+e,p.getAuth("/crops/"+e)).then(function(e){return e.json()}).then(function(e){return e}));case 1:case"end":return t.stop()}},t,this)}));return function(t){return e.apply(this,arguments)}}(),t.update=function(){var e=(0,l["default"])(i["default"].mark(function t(e){return i["default"].wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",p.update_Token(p.APIHost+"/crops/"+e.id,p.getAuth("/crops/"+e.id),(0,s["default"])(e.data)).then(function(e){return e.json()}).then(function(e){return e}));case 1:case"end":return t.stop()}},t,this)}));return function(t){return e.apply(this,arguments)}}(),t.uploadImageAct=function(){var e=(0,l["default"])(i["default"].mark(function t(e){var n;return i["default"].wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=p.APIHost+"/file",t.abrupt("return",p.uploadImg_Token(n,e).then(function(e){return e.json()}).then(function(e){return e}));case 2:case"end":return t.stop()}},t,this)}));return function(t){return e.apply(this,arguments)}}(),n(66),n(23)),p=r(d)},272:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(5),u=r(a),s=n(36),o=r(s),i=n(255),c=n(149);t["default"]={namespace:"crops",state:{list:[],product:{},loading:!1,currentItem:{},modalVisible:!1,modalType:"create",pagination:{showSizeChanger:!0,showQuickJumper:!0,showTotal:function(e){return"\u5171 "+e+" \u6761"},current:1,total:null}},subscriptions:{setup:function(e){var t=e.dispatch,n=e.history;n.listen(function(e){"/product/cropsList"===e.pathname?t({type:"query",payload:e.query}):"/product/crops"===e.pathname?t(e.query.index?{type:"find",payload:e.query.index}:{type:"findSuccess",payload:{product:{}}}):"/order/payImgList"===e.pathname?t({type:"queryPay",payload:e.query}):"/order/addPayImg"===e.pathname&&t(e.query.index?{type:"findPay",payload:e.query.index}:{type:"findSuccess",payload:{product:{}}})})}},effects:{query:o["default"].mark(function l(e,t){var n,r,a=e.payload,u=t.call,s=t.put;return o["default"].wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s({type:"showLoading"});case 2:return e.next=4,u(i.query,(0,c.parse)(a));case 4:if(n=e.sent,r=1,a.page&&(r=parseInt(a.page)),107!=n.statusCode){e.next=10;break}return e.next=10,s({type:"querySuccess",payload:{list:n.resource,pagination:{total:n.sum,current:r}}});case 10:case"end":return e.stop()}},l,this)}),queryPay:o["default"].mark(function d(e,t){var n,r,a=e.payload,u=t.call,s=t.put;return o["default"].wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s({type:"showLoading"});case 2:return e.next=4,u(i.queryPay,(0,c.parse)(a));case 4:if(n=e.sent,r=1,a.page&&(r=parseInt(a.page)),107!=n.statusCode){e.next=12;break}return e.next=10,s({type:"querySuccess",payload:{list:n.resource,pagination:{total:n.sum,current:r}}});case 10:e.next=15;break;case 12:return 403==n.statusCode?message.error("\u6743\u9650\u4e0d\u8db3"):message.error(n.message),e.next=15,s({type:"hideLoading"});case 15:case"end":return e.stop()}},d,this)}),findPay:o["default"].mark(function p(e,t){var n,r=e.payload,a=t.call,u=t.put;return o["default"].wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u({type:"showLoading"});case 2:return e.next=4,a(i.findPay,r);case 4:if(n=e.sent,107!=n.statusCode){e.next=10;break}return e.next=8,u({type:"findSuccess",payload:{product:n.resource}});case 8:e.next=13;break;case 10:return 403==n.statusCode?message.error("\u6743\u9650\u4e0d\u8db3"):message.error(n.message),e.next=13,u({type:"hideLoading"});case 13:case"end":return e.stop()}},p,this)}),find:o["default"].mark(function f(e,t){var n,r=e.payload,a=t.call,u=t.put;return o["default"].wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u({type:"showLoading"});case 2:return e.next=4,a(i.find,r);case 4:if(n=e.sent,107!=n.statusCode){e.next=8;break}return e.next=8,u({type:"findSuccess",payload:{product:n.resource}});case 8:case"end":return e.stop()}},f,this)}),"delete":o["default"].mark(function h(e,t){var n,r=e.payload,a=t.call,u=t.put;return o["default"].wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u({type:"showLoading"});case 2:return e.next=4,a(i.remove,r._id);case 4:if(n=e.sent,103!=n.statusCode){e.next=8;break}return e.next=8,u({type:"delSuccess",payload:{id:r.id}});case 8:case"end":return e.stop()}},h,this)}),create:o["default"].mark(function g(e,t){var n,r=e.payload,a=t.call,u=t.put;return o["default"].wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u({type:"hideModal"});case 2:return e.next=4,u({type:"showLoading"});case 4:return e.next=6,a(i.create,r.data);case 6:if(n=e.sent,101!=n.statusCode){e.next=10;break}return e.next=10,u({type:"createSuccess",payload:{data:n.resource,pagination:{total:n.resource.length,current:1}}});case 10:case"end":return e.stop()}},g,this)}),update:o["default"].mark(function m(e,t){var n,r=e.payload,a=t.call,u=t.put;return o["default"].wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u({type:"hideModal"});case 2:return e.next=4,u({type:"showLoading"});case 4:return e.next=6,a(i.update,r);case 6:if(n=e.sent,105!=n.statusCode){e.next=10;break}return e.next=10,u({type:"updateSuccess",payload:r});case 10:case"end":return e.stop()}},m,this)}),uploadImage:o["default"].mark(function y(e,t){var n,r=e.payload,a=t.call,u=t.put;return o["default"].wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a(i.uploadImageAct,r);case 2:if(n=e.sent,105!=n.statusCode){e.next=6;break}return e.next=6,u({type:"uploadImageSuccess",payload:n});case 6:case"end":return e.stop()}},y,this)})},reducers:{getProduct:function(e,t){return(0,u["default"])({},e,t.payload)},showLoading:function(e){return(0,u["default"])({},e,{loading:!0})},querySuccess:function(e,t){var n=t.payload,r=n.list,a=n.pagination;return(0,u["default"])({},e,{list:r,loading:!1,pagination:(0,u["default"])({},e.pagination,a)})},findSuccess:function(e,t){return(0,u["default"])({},e,t.payload)},createSuccess:function(e,t){var n=t.payload,r=n.data,a=n.pagination,s=e.list;return s.splice(0,0,r),(0,u["default"])({},e,{list:s,loading:!1,pagination:(0,u["default"])({},e.pagination,a)})},delSuccess:function(e,t){var n=t.payload.id,r=e.list;return r.splice(n,1),(0,u["default"])({},e,{list:r,loading:!1})},updateSuccess:function(e,t){var n=t.payload,r=n.key,a=n.user,s=e.list,o=(0,u["default"])({},s[r],a);return s.splice(r,1,o),(0,u["default"])({},e,{list:s,loading:!1})},showModal:function(e,t){return(0,u["default"])({},e,t.payload,{modalVisible:!0})},hideModal:function(e){return(0,u["default"])({},e,{modalVisible:!1})},uploadImageSuccess:function(e,t){}}},e.exports=t["default"]},746:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function a(e){var t=e.crops;return{crops:t}}Object.defineProperty(t,"__esModule",{value:!0});var u=n(14),s=r(u),o=n(87),i=r(o),c=n(90),l=r(c),d=n(24),p=r(d),f=n(52),h=r(f),g=n(2),m=r(g),y=n(4),v=r(y),x=n(3),w=r(x);n(17),n(88),n(19),n(25),n(53);var k=n(1),b=r(k),I=n(136),P=n(255),E=n(109),S=function(e){function t(){var n,r,a;(0,m["default"])(this,t);for(var u=arguments.length,s=Array(u),o=0;o<u;o++)s[o]=arguments[o];return n=r=(0,v["default"])(this,e.call.apply(e,[this].concat(s))),r.state={imgUrl:""},a=n,(0,v["default"])(r,a)}return(0,w["default"])(t,e),t.prototype.componentWillReceiveProps=function(e){var t=e.crops;this.setState({imgUrl:t.product.img?t.product.img:""}),t.product.name?this.refs.name.refs.input.value=t.product.name:"",t.product.goldValue?this.refs.goldValue.refs.input.value=t.product.goldValue:"",t.product.outline?this.refs.outline.refs.input.value=t.product.outline:""},t.prototype.onChange=function(e,t,n){this.setState({value:e})},t.prototype.getLocalImg=function(e){var t=this,n=new FormData;n.append("Filename",e.target.files[0].name),n.append("imgFile",e.target.files[0]),(0,P.uploadImageAct)(n).then(function(e){0==e.error&&t.setState({imgUrl:e.url})})},t.prototype.onSubmit=function(){var e=this.props,t=e.crops,n=e.dispatch;if(!this.refs.name.refs.input.value)return void h["default"].warning("\u8bf7\u8f93\u5165\u540d\u79f0");if(!this.refs.goldValue.refs.input.value)return void h["default"].warning("\u8bf7\u8f93\u5165\u4ef7\u683c");var r={name:this.refs.name.refs.input.value,goldValue:parseInt(this.refs.goldValue.refs.input.value),img:this.state.imgUrl,thumbnail:this.state.imgUrl};this.refs.outline.refs.input.value&&(r.outline=this.refs.outline.refs.input.value),t.product._id?(0,P.update)({id:t.product._id,data:r}).then(function(e){105==e.statusCode?(h["default"].info(e.message),n(E.routerRedux.goBack())):h["default"].error(e.message)}):(0,P.create)(r).then(function(e){101==e.statusCode?(h["default"].info(e.message),n(E.routerRedux.push({pathname:"/product/crops"}))):h["default"].error(e.message)})},t.prototype.changevolume=function(e){this.setState({volume:e})},t.prototype.switchOnRecom=function(e){e?this.setState({onRecom:1}):this.setState({onRecom:0})},t.prototype.render=function(){this.props.crops;return b["default"].createElement("div",{className:"content-inner"},b["default"].createElement(i["default"],{gutter:16,style:{marginTop:20}},b["default"].createElement(p["default"],{span:8,style:{textAlign:"right",paddingTop:6}},b["default"].createElement("h4",null,"\u5546\u54c1\u540d\u79f0",b["default"].createElement("font",{color:"red"},"*"))),b["default"].createElement(p["default"],{span:8},b["default"].createElement(l["default"],{size:"large",style:{width:"100%"},placeholder:"\u5546\u54c1\u540d\u79f0",ref:"name"}))),b["default"].createElement(i["default"],{gutter:16,style:{marginTop:20}},b["default"].createElement(p["default"],{span:8,style:{textAlign:"right",paddingTop:6}},b["default"].createElement("h4",null,"\u5546\u54c1\u4ef7\u683c",b["default"].createElement("font",{color:"red"},"*"))),b["default"].createElement(p["default"],{span:8},b["default"].createElement(l["default"],{size:"large",style:{width:"100%"},placeholder:"\u5546\u54c1\u4ef7\u683c",ref:"goldValue"}))),b["default"].createElement(i["default"],{gutter:16,style:{marginTop:20}},b["default"].createElement(p["default"],{span:8,style:{textAlign:"right",paddingTop:6}},b["default"].createElement("h4",null,"\u4ea7\u54c1\u56fe\u7247")),b["default"].createElement(p["default"],{span:8},b["default"].createElement("form",{id:"uploadForm"},b["default"].createElement("h4",{className:"clearMargin"},b["default"].createElement("style",null,"\n                      .fengmianDiv{\n                        width: 246px;\n                        height: 130px;\n                      }\n                      .fengmianDiv input{ display:none;}\n                      .fengmianDiv img{ width: 110px; height: 130px;}\n                    "),b["default"].createElement("label",{className:"fengmianDiv"},b["default"].createElement("input",{type:"file",onChange:this.getLocalImg.bind(this)}),b["default"].createElement("img",{className:"id_card",ref:"cover",name:"enter_imgsPath",src:this.state.imgUrl})))))),b["default"].createElement(i["default"],{gutter:16,style:{marginTop:20}},b["default"].createElement(p["default"],{span:8,style:{textAlign:"right",paddingTop:6}},b["default"].createElement("h4",null,"\u5546\u54c1\u63cf\u8ff0")),b["default"].createElement(p["default"],{span:8},b["default"].createElement(l["default"],{size:"large",rows:4,type:"textarea",style:{width:"100%"},ref:"outline",placeholder:"\u8bf7\u8f93\u5165\u5546\u54c1\u63cf\u8ff0"}))),b["default"].createElement(i["default"],{type:"flex",justify:"center",gutter:16,style:{marginTop:30}},b["default"].createElement(p["default"],{span:3},b["default"].createElement(s["default"],{style:{width:"100%"},size:"large",type:"primary",onClick:this.onSubmit.bind(this)},"\u63d0\u4ea4"))))},t}(k.Component);t["default"]=(0,I.connect)(a)(S),e.exports=t["default"]}});